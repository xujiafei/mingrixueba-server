const { sequelize } = require('../config/database');

const insertCategoriesSimpleBatch = async () => {
  try {
    console.log('х╝АхзЛцЙ╣щЗПцПТхЕехИЖч▒╗цХ░цНо...');
    
    // ц╕Ечй║шби
    await sequelize.query('DELETE FROM categories');
    await sequelize.query('ALTER TABLE categories AUTO_INCREMENT = 1');
    
    console.log('тЬЕ шбих╖▓ц╕Ечй║');
    
    // ф╜┐чФицЙ╣щЗПцПТхЕея╝МщБ┐хЕНхдНцЭВчЪДхПВцХ░хдДчРЖ
    const insertQueries = [
      // цПТхЕех╣┤ч║з
      `INSERT INTO categories (name, level, parent_id, sort_order) VALUES
       ('х╣╝хНЗх░П', 0, NULL, 1),
       ('ф╕Ах╣┤ч║з', 1, NULL, 2),
       ('ф║Мх╣┤ч║з', 2, NULL, 3),
       ('ф╕Йх╣┤ч║з', 3, NULL, 4),
       ('хЫЫх╣┤ч║з', 4, NULL, 5),
       ('ф║Фх╣┤ч║з', 5, NULL, 6),
       ('хЕнх╣┤ч║з', 6, NULL, 7),
       ('ф╕Гх╣┤ч║з', 7, NULL, 8),
       ('хЕлх╣┤ч║з', 8, NULL, 9),
       ('ф╣Эх╣┤ч║з', 9, NULL, 10)`,
      
      // цПТхЕехнжцЬЯ
      `INSERT INTO categories (name, level, subject, parent_id, sort_order) VALUES
       ('ф╕КхнжцЬЯ', 0, 'хнжцЬЯ', 1, 1), ('ф╕ЛхнжцЬЯ', 0, 'хнжцЬЯ', 1, 2),
       ('ф╕КхнжцЬЯ', 1, 'хнжцЬЯ', 2, 1), ('ф╕ЛхнжцЬЯ', 1, 'хнжцЬЯ', 2, 2),
       ('ф╕КхнжцЬЯ', 2, 'хнжцЬЯ', 3, 1), ('ф╕ЛхнжцЬЯ', 2, 'хнжцЬЯ', 3, 2),
       ('ф╕КхнжцЬЯ', 3, 'хнжцЬЯ', 4, 1), ('ф╕ЛхнжцЬЯ', 3, 'хнжцЬЯ', 4, 2),
       ('ф╕КхнжцЬЯ', 4, 'хнжцЬЯ', 5, 1), ('ф╕ЛхнжцЬЯ', 4, 'хнжцЬЯ', 5, 2),
       ('ф╕КхнжцЬЯ', 5, 'хнжцЬЯ', 6, 1), ('ф╕ЛхнжцЬЯ', 5, 'хнжцЬЯ', 6, 2),
       ('ф╕КхнжцЬЯ', 6, 'хнжцЬЯ', 7, 1), ('ф╕ЛхнжцЬЯ', 6, 'хнжцЬЯ', 7, 2),
       ('ф╕КхнжцЬЯ', 7, 'хнжцЬЯ', 8, 1), ('ф╕ЛхнжцЬЯ', 7, 'хнжцЬЯ', 8, 2),
       ('ф╕КхнжцЬЯ', 8, 'хнжцЬЯ', 9, 1), ('ф╕ЛхнжцЬЯ', 8, 'хнжцЬЯ', 9, 2),
       ('ф╕КхнжцЬЯ', 9, 'хнжцЬЯ', 10, 1), ('ф╕ЛхнжцЬЯ', 9, 'хнжцЬЯ', 10, 2)`,
      
      // цПТхЕечзСчЫоя╝Их╣╝хНЗх░Пя╝Й
      `INSERT INTO categories (name, level, subject, parent_id, sort_order) VALUES
       ('шпнцЦЗ', 0, 'шпнцЦЗ', 11, 1), ('цХ░хнж', 0, 'цХ░хнж', 11, 2),
       ('шпнцЦЗ', 0, 'шпнцЦЗ', 12, 1), ('цХ░хнж', 0, 'цХ░хнж', 12, 2)`,
      
      // цПТхЕечзСчЫоя╝Иф╕АуАБф║Мх╣┤ч║зя╝Й
      `INSERT INTO categories (name, level, subject, parent_id, sort_order) VALUES
       ('шпнцЦЗ', 1, 'шпнцЦЗ', 13, 1), ('цХ░хнж', 1, 'цХ░хнж', 13, 2),
       ('шпнцЦЗ', 1, 'шпнцЦЗ', 14, 1), ('цХ░хнж', 1, 'цХ░хнж', 14, 2),
       ('шпнцЦЗ', 2, 'шпнцЦЗ', 15, 1), ('цХ░хнж', 2, 'цХ░хнж', 15, 2),
       ('шпнцЦЗ', 2, 'шпнцЦЗ', 16, 1), ('цХ░хнж', 2, 'цХ░хнж', 16, 2)`,
      
      // цПТхЕечзСчЫоя╝Иф╕ЙхИ░хЕнх╣┤ч║зя╝Й
      `INSERT INTO categories (name, level, subject, parent_id, sort_order) VALUES
       ('шпнцЦЗ', 3, 'шпнцЦЗ', 17, 1), ('цХ░хнж', 3, 'цХ░хнж', 17, 2), ('шЛ▒шпн', 3, 'шЛ▒шпн', 17, 3),
       ('шпнцЦЗ', 3, 'шпнцЦЗ', 18, 1), ('цХ░хнж', 3, 'цХ░хнж', 18, 2), ('шЛ▒шпн', 3, 'шЛ▒шпн', 18, 3),
       ('шпнцЦЗ', 4, 'шпнцЦЗ', 19, 1), ('цХ░хнж', 4, 'цХ░хнж', 19, 2), ('шЛ▒шпн', 4, 'шЛ▒шпн', 19, 3),
       ('шпнцЦЗ', 4, 'шпнцЦЗ', 20, 1), ('цХ░хнж', 4, 'цХ░хнж', 20, 2), ('шЛ▒шпн', 4, 'шЛ▒шпн', 20, 3),
       ('шпнцЦЗ', 5, 'шпнцЦЗ', 21, 1), ('цХ░хнж', 5, 'цХ░хнж', 21, 2), ('шЛ▒шпн', 5, 'шЛ▒шпн', 21, 3),
       ('шпнцЦЗ', 5, 'шпнцЦЗ', 22, 1), ('цХ░хнж', 5, 'цХ░хнж', 22, 2), ('шЛ▒шпн', 5, 'шЛ▒шпн', 22, 3),
       ('шпнцЦЗ', 6, 'шпнцЦЗ', 23, 1), ('цХ░хнж', 6, 'цХ░хнж', 23, 2), ('шЛ▒шпн', 6, 'шЛ▒шпн', 23, 3),
       ('шпнцЦЗ', 6, 'шпнцЦЗ', 24, 1), ('цХ░хнж', 6, 'цХ░хнж', 24, 2), ('шЛ▒шпн', 6, 'шЛ▒шпн', 24, 3)`,
      
      // цПТхЕечзСчЫоя╝Иф╕ГхИ░ф╣Эх╣┤ч║зя╝Й
      `INSERT INTO categories (name, level, subject, parent_id, sort_order) VALUES
       ('шпнцЦЗ', 7, 'шпнцЦЗ', 25, 1), ('цХ░хнж', 7, 'цХ░хнж', 25, 2), ('шЛ▒шпн', 7, 'шЛ▒шпн', 25, 3),
       ('чФЯчЙй', 7, 'чФЯчЙй', 25, 4), ('щБУц│Х', 7, 'щБУц│Х', 25, 5), ('хОЖхП▓', 7, 'хОЖхП▓', 25, 6), ('хЬ░чРЖ', 7, 'хЬ░чРЖ', 25, 7),
       ('шпнцЦЗ', 7, 'шпнцЦЗ', 26, 1), ('цХ░хнж', 7, 'цХ░хнж', 26, 2), ('шЛ▒шпн', 7, 'шЛ▒шпн', 26, 3),
       ('чФЯчЙй', 7, 'чФЯчЙй', 26, 4), ('щБУц│Х', 7, 'щБУц│Х', 26, 5), ('хОЖхП▓', 7, 'хОЖхП▓', 26, 6), ('хЬ░чРЖ', 7, 'хЬ░чРЖ', 26, 7),
       ('шпнцЦЗ', 8, 'шпнцЦЗ', 27, 1), ('цХ░хнж', 8, 'цХ░хнж', 27, 2), ('шЛ▒шпн', 8, 'шЛ▒шпн', 27, 3),
       ('чФЯчЙй', 8, 'чФЯчЙй', 27, 4), ('щБУц│Х', 8, 'щБУц│Х', 27, 5), ('хОЖхП▓', 8, 'хОЖхП▓', 27, 6), ('хЬ░чРЖ', 8, 'хЬ░чРЖ', 27, 7),
       ('шпнцЦЗ', 8, 'шпнцЦЗ', 28, 1), ('цХ░хнж', 8, 'цХ░хнж', 28, 2), ('шЛ▒шпн', 8, 'шЛ▒шпн', 28, 3),
       ('чФЯчЙй', 8, 'чФЯчЙй', 28, 4), ('щБУц│Х', 8, 'щБУц│Х', 28, 5), ('хОЖхП▓', 8, 'хОЖхП▓', 28, 6), ('хЬ░чРЖ', 8, 'хЬ░чРЖ', 28, 7),
       ('шпнцЦЗ', 9, 'шпнцЦЗ', 29, 1), ('цХ░хнж', 9, 'цХ░хнж', 29, 2), ('шЛ▒шпн', 9, 'шЛ▒шпн', 29, 3),
       ('чФЯчЙй', 9, 'чФЯчЙй', 29, 4), ('щБУц│Х', 9, 'щБУц│Х', 29, 5), ('хОЖхП▓', 9, 'хОЖхП▓', 29, 6), ('хЬ░чРЖ', 9, 'хЬ░чРЖ', 29, 7),
       ('шпнцЦЗ', 9, 'шпнцЦЗ', 30, 1), ('цХ░хнж', 9, 'цХ░хнж', 30, 2), ('шЛ▒шпн', 9, 'шЛ▒шпн', 30, 3),
       ('чФЯчЙй', 9, 'чФЯчЙй', 30, 4), ('щБУц│Х', 9, 'щБУц│Х', 30, 5), ('хОЖхП▓', 9, 'хОЖхП▓', 30, 6), ('хЬ░чРЖ', 9, 'хЬ░чРЖ', 30, 7)`
    ];

    // цЙзшбМцЙАцЬЙцПТхЕе
    for (let i = 0; i < insertQueries.length; i++) {
      console.log(`цЙзшбМчмм ${i + 1}/${insertQueries.length} цЙ╣цПТхЕе...`);
      await sequelize.query(insertQueries[i]);
    }

    console.log('тЬЕ цЙАцЬЙцХ░цНоцПТхЕехоМцИР');

    // щкМшпБч╗УцЮЬ
    const [totalCount] = await sequelize.query('SELECT COUNT(*) as count FROM categories');
    const [gradeCount] = await sequelize.query('SELECT COUNT(*) as count FROM categories WHERE parent_id IS NULL');
    const [semesterCount] = await sequelize.query('SELECT COUNT(*) as count FROM categories WHERE subject = "хнжцЬЯ"');
    const [subjectCount] = await sequelize.query('SELECT COUNT(*) as count FROM categories WHERE subject NOT IN ("хнжцЬЯ", NULL)');

    console.log('\nЁЯУК цПТхЕеч╗УцЮЬч╗Яшоб:');
    console.log(`- цА╗хИЖч▒╗цХ░: ${totalCount[0].count}`);
    console.log(`- х╣┤ч║зцХ░щЗП: ${gradeCount[0].count}`);
    console.log(`- хнжцЬЯцХ░щЗП: ${semesterCount[0].count}`);
    console.log(`- чзСчЫоцХ░щЗП: ${subjectCount[0].count}`);

  } catch (error) {
    console.error('тЭМ цПТхЕехИЖч▒╗цХ░цНохд▒ш┤е:', error.message);
    throw error;
  }
};

if (require.main === module) {
  insertCategoriesSimpleBatch()
    .then(() => {
      console.log('\nЁЯОЙ хИЖч▒╗цХ░цНоцЙ╣щЗПцПТхЕехоМцИРя╝Б');
      process.exit(0);
    })
    .catch((error) => {
      console.error('тЭМ хИЖч▒╗цХ░цНоцПТхЕехд▒ш┤е');
      process.exit(1);
    });
}